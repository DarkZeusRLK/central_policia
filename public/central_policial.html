<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Intranet Policial | REVOADA RJ</title>
  <link rel="shortcut icon" href="images/Logo_policia.png" type="image/x-icon">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="../style/main.css">
  <style>
    /* Estilos Exclusivos da Dashboard (Sidebar) */
    body {
      display: flex;
      min-height: 100vh;
      background-color: #0f172a;
      overflow-x: hidden;
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    /* Sidebar Lateral */
    .sidebar {
      width: 260px;
      background: #1e293b;
      border-right: 1px solid rgba(255, 255, 255, 0.05);
      display: flex;
      flex-direction: column;
      position: fixed;
      height: 100%;
      z-index: 1000;
    }

    .sidebar-header {
      padding: 2rem;
      text-align: center;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      flex-shrink: 0;
    }

    .sidebar-header i {
      font-size: 2.5rem;
      color: var(--accent-gold);
      margin-bottom: 10px;
    }

    .sidebar-header h2 {
      color: white;
      font-size: 1.2rem;
      margin: 0;
    }

    .sidebar-menu {
      list-style: none;
      padding: 20px 0;
      flex: 1;
      overflow-y: auto;
    }

    .sidebar-menu::-webkit-scrollbar {
      width: 5px;
    }

    .sidebar-menu::-webkit-scrollbar-thumb {
      background: #334155;
      border-radius: 5px;
    }

    .sidebar-section-title {
      font-size: 0.7rem;
      text-transform: uppercase;
      color: #64748b;
      padding: 15px 25px 5px 25px;
      font-weight: bold;
      letter-spacing: 1px;
    }

    .sidebar-menu li a {
      display: flex;
      align-items: center;
      padding: 12px 25px;
      color: #94a3b8;
      text-decoration: none;
      transition: 0.2s;
      font-weight: 500;
      gap: 12px;
      font-size: 0.95rem;
    }

    .sidebar-menu li a:hover,
    .sidebar-menu li a.active {
      background: rgba(251, 191, 36, 0.05);
      color: var(--accent-gold);
      border-right: 3px solid var(--accent-gold);
    }

    .user-mini-profile {
      padding: 20px;
      border-top: 1px solid rgba(255, 255, 255, 0.05);
      display: flex;
      align-items: center;
      gap: 10px;
      color: white;
      flex-shrink: 0;
      background: #1e293b;
    }

    /* Conte√∫do Principal */
    .dashboard-content {
      margin-left: 260px;
      flex: 1;
      padding: 40px;
      width: 100%;
    }

    .dash-section {
      display: none;
      animation: fadeIn 0.4s ease;
    }

    .dash-section:not(.hidden) {
      display: block;
    }

    /* --- NOVOS ESTILOS: GRID DASHBOARD --- */
    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .widget-card {
      background: #1e293b;
      border: 1px solid rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      padding: 20px;
      display: flex;
      flex-direction: column;
    }

    .widget-title {
      color: var(--accent-gold);
      font-size: 1.1rem;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      padding-bottom: 10px;
    }

    /* Estilo Ranking */
    .ranking-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .ranking-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.03);
      color: #e2e8f0;
    }

    .ranking-item:last-child {
      border-bottom: none;
    }

    .rank-pos {
      font-weight: bold;
      width: 30px;
    }

    .rank-1 {
      color: #FFD700;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.4);
    }

    .rank-2 {
      color: #C0C0C0;
    }

    .rank-3 {
      color: #CD7F32;
    }

    .rank-name {
      flex: 1;
      margin-left: 10px;
    }

    .rank-score {
      background: rgba(255, 255, 255, 0.1);
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 0.85rem;
    }

    /* Estilo √öltima Not√≠cia */
    .news-widget-content {
      position: relative;
      height: 200px;
      border-radius: 8px;
      overflow: hidden;
      display: flex;
      align-items: flex-end;
      background-size: cover;
      background-position: center;
    }

    .news-overlay {
      background: linear-gradient(to top, rgba(0, 0, 0, 0.9), transparent);
      width: 100%;
      padding: 15px;
      color: white;
    }

    /* Cards de Cursos */
    .course-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .course-card {
      background: #1e293b;
      border-radius: 12px;
      overflow: hidden;
      border: 1px solid #334155;
      transition: 0.3s;
      display: flex;
      flex-direction: column;
    }

    .course-card:hover {
      transform: translateY(-5px);
      border-color: var(--accent-gold);
    }

    /* Estilo especial para o curso restrito */
    .course-card.special {
      border: 1px solid #10b981;
      box-shadow: 0 0 15px rgba(16, 185, 129, 0.1);
    }

    .course-card.special .course-thumb {
      background: linear-gradient(45deg, #064e3b, #0f172a);
      color: #34d399;
    }

    .course-thumb {
      height: 160px;
      background: #0f172a;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #475569;
    }

    .course-body {
      padding: 20px;
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .course-body h3 {
      color: white;
      margin-bottom: 10px;
      font-size: 1.1rem;
    }

    .course-body p {
      color: #94a3b8;
      font-size: 0.9rem;
      margin-bottom: 15px;
      flex: 1;
    }

    .course-actions {
      margin-top: auto;
      padding-top: 15px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    /* Bot√£o Canva (Roxo) */
    .btn-canva {
      background: linear-gradient(45deg, #7e22ce, #a855f7);
      color: white;
      padding: 8px 15px;
      border-radius: 6px;
      text-decoration: none;
      font-size: 0.85rem;
      display: inline-flex;
      align-items: center;
      gap: 5px;
      transition: 0.2s;
    }

    .btn-canva:hover {
      filter: brightness(1.2);
    }

    /* Bot√£o Video (Azul) */
    .btn-video {
      background: linear-gradient(45deg, #2563eb, #3b82f6);
      color: white;
      padding: 8px 15px;
      border-radius: 6px;
      text-decoration: none;
      font-size: 0.85rem;
      display: inline-flex;
      align-items: center;
      gap: 5px;
      transition: 0.2s;
    }

    .btn-video:hover {
      filter: brightness(1.2);
    }

    /* Estilos do Formul√°rio de Not√≠cias */
    .form-dark-input {
      width: 100%;
      padding: 12px;
      background: #0f172a;
      border: 1px solid #334155;
      color: white;
      border-radius: 8px;
      margin-top: 5px;
      font-family: inherit;
    }

    .form-dark-input:focus {
      border-color: var(--accent-gold);
      outline: none;
    }

    .glass-panel {
      background: #1e293b;
      border: 1px solid rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      padding: 30px;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .sidebar-logo {
      width: 80px;
      height: auto;
      margin-bottom: 15px;
      object-fit: contain;
      filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.3));
    }
  </style>
</head>

<body>

  <aside class="sidebar">
    <div class="sidebar-header">
      <img src="images/Logo_policia.png" alt="Logo Pol√≠cia" class="sidebar-logo">
      <h2>INTRANET<br>POLICIAL</h2>
    </div>

    <ul class="sidebar-menu">
      <li><a href="#" onclick="switchTab('home', this)" class="active"><i class="fa-solid fa-gauge-high"></i> Painel Operacional</a></li>

      <li class="sidebar-section-title">DEPARTAMENTOS</li>
      <li><a href="departamentopcerj.html"><i class="fa-solid fa-magnifying-glass"></i> PCERJ</a></li>
      <li><a href="batalhaopmerj.html"><i class="fa-solid fa-person-military-rifle"></i> PMERJ</a></li>
      <li><a href="departamentoprf.html"><i class="fa-solid fa-road"></i> PRF</a></li>
      <li><a href="departamentopf.html"><i class="fa-solid fa-building-shield"></i> PF</a></li>

      <li class="sidebar-section-title">SERVI√áOS</li>
      <li><a href="../index.html#boletim"><i class="fa-solid fa-clipboard"></i> Registrar B.O.</a></li>

      <li class="sidebar-section-title">INTERNO</li>
      <li><a href="#" onclick="switchTab('cursos', this)"><i class="fa-solid fa-graduation-cap"></i> Cursos e Treinamentos</a></li>

      <li id="tab-jornalista" class="hidden">
        <a href="#" onclick="switchTab('jornalistas', this)"><i class="fa-solid fa-camera"></i> √Årea Jornalista</a>
      </li>

      <li style="margin-top: 20px; border-top: 1px solid rgba(255,255,255,0.05);">
        <a href="../index.html"><i class="fa-solid fa-power-off"></i> Sair / Voltar ao In√≠cio</a>
      </li>
    </ul>

    <div class="user-mini-profile" id="sidebar-user">
    </div>
  </aside>

  <main class="dashboard-content">

    <section id="sec-home" class="dash-section">
      <h1 style="color: white; margin-bottom: 10px;">Painel Operacional</h1>
      <p style="color: #94a3b8;">Bem-vindo √† √°rea restrita, oficial.</p>

      <div style="margin-top: 20px; background: rgba(251, 191, 36, 0.1); padding: 20px; border-radius: 12px; border-left: 5px solid var(--accent-gold);">
        <h4 style="color: var(--accent-gold); margin: 0;"><i class="fa-solid fa-triangle-exclamation"></i> Aviso do Comando</h4>
        <p style="color: #cbd5e1; margin-top: 5px; font-size: 0.9rem;">Lembre-se de bater o ponto no Discord antes de iniciar o patrulhamento. O uso desta intranet √© monitorado.</p>
      </div>

      <div class="dashboard-grid">
        <div class="widget-card">
          <div class="widget-title">
            <i class="fa-solid fa-trophy"></i> Ranking de Pris√µes
          </div>
          <div id="ranking-container">
            <p style="color: #64748b; font-size: 0.9rem;">Carregando ranking do canal oficial...</p>
          </div>
        </div>

        <div class="widget-card">
          <div class="widget-title">
            <i class="fa-regular fa-newspaper"></i> √öltimo Informativo
          </div>
          <div id="latest-news-container">
            <p style="color: #64748b; font-size: 0.9rem;">Buscando not√≠cias...</p>
          </div>
        </div>
      </div>
    </section>

    <section id="sec-cursos" class="dash-section hidden">
      <h1 style="color: white;">Cursos de Forma√ß√£o</h1>
      <p style="color: #94a3b8;">Acervo de treinamentos, procedimentos operacionais e t√°ticas especiais.</p>

      <div class="course-grid">

        <div class="course-card">
          <div class="course-thumb"><i class="fa-solid fa-person-military-to-person fa-3x"></i></div>
          <div class="course-body">
            <h3>Conduta Policial e Ordem Unida</h3>
            <p>Fundamentos de hierarquia, disciplina, postura e √©tica militar.</p>
            <div class="course-actions">
              <a href="#" class="btn-canva" target="_blank"><i class="fa-solid fa-paintbrush"></i> Canva</a>
              <a href="#" class="btn-video" target="_blank"><i class="fa-solid fa-play"></i> V√≠deo</a>
            </div>
          </div>
        </div>

        <div class="course-card">
          <div class="course-thumb"><i class="fa-solid fa-headset fa-3x"></i></div>
          <div class="course-body">
            <h3>Patrulha e Modula√ß√£o</h3>
            <p>T√°ticas de patrulhamento ostensivo, abordagem segura e c√≥digos Q de r√°dio.</p>
            <div class="course-actions">
              <a href="#" class="btn-canva" target="_blank"><i class="fa-solid fa-paintbrush"></i> Canva</a>
              <a href="#" class="btn-video" target="_blank"><i class="fa-solid fa-play"></i> V√≠deo</a>
            </div>
          </div>
        </div>

        <div class="course-card">
          <div class="course-thumb"><i class="fa-solid fa-magnifying-glass-chart fa-3x"></i></div>
          <div class="course-body">
            <h3>Detec√ß√£o de Il√≠citos</h3>
            <p>Identifica√ß√£o de subst√¢ncias, armas modificadas e procedimento de revista.</p>
            <div class="course-actions">
              <a href="#" class="btn-canva" target="_blank"><i class="fa-solid fa-paintbrush"></i> Canva</a>
              <a href="#" class="btn-video" target="_blank"><i class="fa-solid fa-play"></i> V√≠deo</a>
            </div>
          </div>
        </div>

        <div class="course-card">
          <div class="course-thumb"><i class="fa-solid fa-lock fa-3x"></i></div>
          <div class="course-body">
            <h3>Curso de Carcereiro</h3>
            <p>Gest√£o prisional, transporte de detentos e seguran√ßa de celas.</p>
            <div class="course-actions">
              <a href="#" class="btn-canva" target="_blank"><i class="fa-solid fa-paintbrush"></i> Canva</a>
              <a href="#" class="btn-video" target="_blank"><i class="fa-solid fa-play"></i> V√≠deo</a>
            </div>
          </div>
        </div>

        <div class="course-card special restricted-card hidden" style="display: none;">
          <div class="course-thumb" style="background: linear-gradient(45deg, #0f172a, #1e293b); color: #34d399;">
            <i class="fa-solid fa-fingerprint fa-3x"></i>
          </div>
          <div class="course-body">
            <h3 style="color: #34d399;">Per√≠cia Criminal</h3>
            <p>Investiga√ß√£o forense, coleta de evid√™ncias, an√°lise de cena de crime e bal√≠stica.</p>
            <div class="course-actions">
              <a href="#" class="btn-canva" target="_blank"><i class="fa-solid fa-paintbrush"></i> Canva</a>
              <a href="#" class="btn-video" target="_blank"><i class="fa-solid fa-play"></i> V√≠deo</a>
            </div>
          </div>
        </div>

        <div class="course-card special restricted-card hidden" style="display: none;">
          <div class="course-thumb" style="background: linear-gradient(45deg, #3f1010, #0f172a); color: #f87171;">
            <i class="fa-solid fa-mask fa-3x"></i>
          </div>
          <div class="course-body">
            <h3 style="color: #f87171;">Combate ao Tr√°fico</h3>
            <p>Opera√ß√µes de DTE, intelig√™ncia, invas√£o t√°tica e intercepta√ß√£o de cargas.</p>
            <div class="course-actions">
              <a href="#" class="btn-canva" target="_blank"><i class="fa-solid fa-paintbrush"></i> Canva</a>
              <a href="#" class="btn-video" target="_blank"><i class="fa-solid fa-play"></i> V√≠deo</a>
            </div>
          </div>
        </div>

      </div>
    </section>

    <section id="sec-jornalistas" class="dash-section hidden">
      <h1 style="color: white;"><i class="fa-solid fa-newspaper"></i> Sala de Imprensa</h1>
      <p style="color: #94a3b8;">√Årea exclusiva para reda√ß√£o e m√≠dia.</p>

      <div class="glass-panel" style="margin-top: 20px; max-width: 800px;">
        <h3 style="color: var(--accent-gold); margin-bottom: 20px;">
          <i class="fa-solid fa-pen-nib"></i> Criar Nova Mat√©ria
        </h3>

        <form id="form-news">
          <div style="margin-bottom: 15px;">
            <label style="color: #cbd5e1; font-size: 0.9rem;">Manchete da Not√≠cia</label>
            <input type="text" name="title" required placeholder="Ex: Grande opera√ß√£o apreende cargas na Zona Norte" class="form-dark-input">
          </div>

          <div style="margin-bottom: 15px;">
            <label style="color: #cbd5e1; font-size: 0.9rem;">Link da Imagem (URL)</label>
            <input type="url" name="imageUrl" required placeholder="https://..." class="form-dark-input">
          </div>

          <div style="margin-bottom: 20px;">
            <label style="color: #cbd5e1; font-size: 0.9rem;">Corpo da Not√≠cia</label>
            <textarea name="content" rows="6" required placeholder="Digite os detalhes da ocorr√™ncia aqui..." class="form-dark-input"></textarea>
          </div>

          <button type="submit" class="btn-primary" style="width: 100%; padding: 12px; background: var(--accent-gold); color: #0f172a; font-weight: bold; border: none; border-radius: 8px; cursor: pointer; transition: 0.3s;">
            <i class="fa-solid fa-paper-plane"></i> Publicar no Jornal
          </button>
        </form>
      </div>
    </section>

  </main>

  <script>
    /* ==========================================================================
       NOTIFICA√á√ïES 
       ========================================================================== */
    const Notify = {
      container: null,
      init() {
        if (!document.querySelector(".notification-container")) {
          this.container = document.createElement("div");
          this.container.className = "notification-container";
          document.body.appendChild(this.container);
        } else {
          this.container = document.querySelector(".notification-container");
        }
      },
      show(message, type = "info") {
        if (!this.container) this.init();
        const toast = document.createElement("div");
        toast.className = `toast ${type}`;
        let icon = "fa-info-circle";
        if (type === "success") icon = "fa-check-circle";
        if (type === "error") icon = "fa-exclamation-triangle";
        if (type === "loading") icon = "fa-spinner fa-spin";
        toast.innerHTML = `<i class="fas ${icon}"></i> <span>${message}</span>`;
        this.container.appendChild(toast);
        if (type !== "loading") {
          setTimeout(() => {
            toast.style.animation = "slideIn 0.3s reverse forwards";
            setTimeout(() => toast.remove(), 300);
          }, 4000);
        }
      },
      success(msg) { this.show(msg, "success"); },
      error(msg) { this.show(msg, "error"); },
      info(msg) { this.show(msg, "info"); },
      loading(msg) { this.show(msg, "loading"); },
    };

    /* ==========================================================================
       L√ìGICA PRINCIPAL
       ========================================================================== */
    document.addEventListener("DOMContentLoaded", async () => {
      Notify.init();

      // 1. Verifica Sess√£o
      const user = JSON.parse(localStorage.getItem("revoada_user"));
      if (!user) {
        window.location.href = "../index.html";
        return;
      }

      // 2. Preenche User Sidebar
      const sidebarUser = document.getElementById("sidebar-user");
      if (sidebarUser) {
        sidebarUser.innerHTML = `
            <img src="https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png" style="width: 40px; height: 40px; border-radius: 50%;">
            <div>
                <div style="font-weight: bold; font-size: 0.9rem;">${user.username}</div>
                <div style="font-size: 0.75rem; color: #64748b;">Online</div>
            </div>
        `;
      }

      // 3. Verifica Acesso Jornalista
      const isJournalist = localStorage.getItem("revoada_is_journalist") === "true";
      if (isJournalist) {
        const tabJornalista = document.getElementById("tab-jornalista");
        if (tabJornalista) tabJornalista.classList.remove("hidden");
      }

      // ================================================================
      // 4. L√ìGICA DE PERMISS√ÉO (API + ENV)
      // ================================================================
      await checkSpecialCoursesAccess(user);

      // 5. Carrega Dados da Dashboard
      loadDashboardData();

      // 6. L√≥gica de Envio de Not√≠cia
      setupNewsForm(user);
    });

    // --- FUN√á√ÉO PARA VERIFICAR ACESSO AOS CURSOS RESTRITOS ---
    async function checkSpecialCoursesAccess(user) {
      let allowedRoleIds = [];

      try {
        // Tenta buscar do backend (que l√™ o .env)
        // Crie uma rota no seu backend tipo: app.get('/api/config/roles', (req, res) => res.json({ pcerj_pf: process.env.PCERJ_PF_ROLE_ID }))
        const response = await fetch('/api/config/roles');

        if (response.ok) {
          const config = await response.json();
          // Supondo que o backend retorne { pcerj_pf: "12345,67890" } ou array
          if (config.pcerj_pf) {
            // Se vier separado por v√≠rgula ou array, tratamos aqui
            allowedRoleIds = Array.isArray(config.pcerj_pf) ? config.pcerj_pf : config.pcerj_pf.split(',');
          }
        } else {
          throw new Error("API de config n√£o encontrada");
        }
      } catch (error) {
        console.warn("‚ö†Ô∏è N√£o foi poss√≠vel ler IDs da API (Backend offline ou rota inexistente). Usando Fallback.");

        // FALLBACK MANUAL (Coloque seus IDs aqui caso a API falhe)
        allowedRoleIds = ["1053687224320933888", "1447060519726088212"];
      }

      // DEBUG: Para voc√™ ver no F12 o que est√° acontecendo
      console.log("üîç [DEBUG] IDs Permitidos (Config):", allowedRoleIds);
      console.log("üë§ [DEBUG] IDs do Usu√°rio (User):", user.roles);

      // Verifica permiss√£o
      if (user.roles && Array.isArray(user.roles)) {
        // Verifica se ALGUM dos cargos do usu√°rio est√° na lista de permitidos
        // Convertemos tudo para String para evitar erros de tipo (n√∫mero vs string)
        const hasAccess = user.roles.some(userRole =>
          allowedRoleIds.includes(String(userRole))
        );

        if (hasAccess) {
          console.log("‚úÖ Acesso aos cursos especiais CONCEDIDO.");
          const restrictedCards = document.querySelectorAll(".restricted-card");
          restrictedCards.forEach(card => {
            card.style.display = "flex";
            card.classList.remove("hidden");
          });
        } else {
          console.log("‚ùå Acesso aos cursos especiais NEGADO.");
        }
      } else {
        console.log("‚ö†Ô∏è Usu√°rio n√£o possui lista de cargos (user.roles vazio).");
      }
    }

    // --- CONFIGURA√á√ÉO DO FORMUL√ÅRIO DE NOT√çCIAS ---
    function setupNewsForm(user) {
      const formNews = document.getElementById("form-news");
      if (formNews) {
        formNews.addEventListener("submit", async (e) => {
          e.preventDefault();
          const btn = formNews.querySelector("button");
          const originalText = btn.innerHTML;
          Notify.loading("Conectando √† central...");
          btn.innerHTML = "<i class='fa-solid fa-spinner fa-spin'></i> Enviando...";
          btn.disabled = true;
          btn.style.opacity = "0.7";

          const formData = new FormData(formNews);
          const data = Object.fromEntries(formData.entries());
          data.userId = user.id;

          try {
            const response = await fetch("/api/publish-news", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(data)
            });
            if (response.ok) {
              Notify.success("Mat√©ria publicada no Jornal!");
              formNews.reset();
              loadDashboardData();
            } else {
              Notify.error("Erro ao publicar a mat√©ria.");
            }
          } catch (err) {
            console.error(err);
            Notify.error("Erro de conex√£o com o servidor.");
          } finally {
            btn.innerHTML = originalText;
            btn.disabled = false;
            btn.style.opacity = "1";
          }
        });
      }
    }

    // --- NAVEGA√á√ÉO ENTRE ABAS ---
    window.switchTab = function (tabName, element) { // Exposto globalmente
      document.querySelectorAll(".dash-section").forEach(el => el.classList.add("hidden"));
      document.querySelectorAll(".sidebar-menu a").forEach(el => el.classList.remove("active"));
      document.getElementById(`sec-${tabName}`).classList.remove("hidden");
      element.classList.add("active");
    }

    // --- FUN√á√ÉO PARA CARREGAR OS WIDGETS ---
    async function loadDashboardData() {
      const rankingContainer = document.getElementById('ranking-container');

      // ... (L√≥gica do Ranking mant√©m igual) ...
      try {
        const mockRankingData = [
          { name: "Ten. Silva", score: 42 },
          { name: "Cb. Oliveira", score: 38 },
          { name: "Sd. Souza", score: 25 },
          { name: "Ag. Pereira", score: 12 },
          { name: "Del. Mendes", score: 10 }
        ];

        let html = '<ul class="ranking-list">';
        mockRankingData.forEach((user, index) => {
          let rankClass = '';
          let icon = '';
          if (index === 0) { rankClass = 'rank-1'; icon = '<i class="fa-solid fa-crown"></i>'; }
          else if (index === 1) { rankClass = 'rank-2'; icon = '<i class="fa-solid fa-medal"></i>'; }
          else if (index === 2) { rankClass = 'rank-3'; icon = '<i class="fa-solid fa-medal"></i>'; }
          else { rankClass = ''; icon = `#${index + 1}`; }

          html += `
                    <li class="ranking-item">
                        <div class="rank-pos ${rankClass}">${icon}</div>
                        <div class="rank-name">${user.name}</div>
                        <div class="rank-score">${user.score} pris√µes</div>
                    </li>
                `;
        });
        html += '</ul>';
        rankingContainer.innerHTML = html;
      } catch (error) {
        rankingContainer.innerHTML = '<p style="color:#ef4444">Erro ao carregar ranking.</p>';
      }

      // ... (L√≥gica de Not√≠cias mant√©m igual) ...
      const newsContainer = document.getElementById('latest-news-container');
      try {
        const response = await fetch('/api/news');
        const news = await response.json();

        if (news && news.length > 0) {
          const latest = news[0];
          newsContainer.innerHTML = `
                    <div class="news-widget-content" style="background-image: url('${latest.image || 'images/news-placeholder.jpg'}');">
                        <div class="news-overlay">
                            <h4 style="margin: 0; font-size: 1rem; text-shadow: 1px 1px 2px black;">${latest.title}</h4>
                            <small style="color: #cbd5e1; font-size: 0.8rem;">Postado recentemente</small>
                        </div>
                    </div>
                `;
        } else {
          newsContainer.innerHTML = '<p style="color:#94a3b8">Nenhuma not√≠cia recente encontrada.</p>';
        }
      } catch (error) {
        newsContainer.innerHTML = `
                <div class="news-widget-content" style="background-image: url('https://static.vecteezy.com/system/resources/thumbnails/006/299/370/original/world-breaking-news-digital-earth-hud-rotating-globe-rotating-free-video.jpg');">
                    <div class="news-overlay">
                        <h4 style="margin: 0; font-size: 1rem;">Sem not√≠cias no momento</h4>
                        <small style="color: #cbd5e1;">Aguardando atualiza√ß√µes...</small>
                    </div>
                </div>
            `;
      }
    }
  </script>
  <script src="../api/ler_cargo.js"></script>
</body>

</html>